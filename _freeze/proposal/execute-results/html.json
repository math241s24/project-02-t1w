{
  "hash": "34f40c4f97ecd5a03d8f46db8cad9b2e",
  "result": {
    "markdown": "---\ntitle: \"The Attractiveness of Cities\"\nsubtitle: \"Proposal\"\nauthors: \"James Aas, Audrey Mills, Jameson Oates\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(leaflet)\nlibrary(tmap)\nlibrary(readr)\n```\n:::\n\n\n## Datasets\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_economic_data <- read.csv(\"data/state_economic_data.csv\")\n\nstate_abortion_data <- read.csv(\"data/abortions_dataset.csv\")\n\nstate_immigration_data <- read.csv(\"data/interstate_migration_data.csv\")\n\npresidential_election_data <- read.csv(\"data/presidential_election_data.csv\")\n\nstate <- c(\"Alabama\", \n           \"Alaska\", \n           \"Arizona\", \n           \"Arkansas\",\n           \"California\",\n           \"Colorado\",\n           \"Connecticut\",\n           \"Delaware\",\n           \"District of Columbia\",\n           \"Florida\",\n           \"Georgia\",\n           \"Hawaii\",\n           \"Idaho\",\n           \"Illinois\",\n           \"Indiana\",\n           \"Iowa\",\n           \"Kansas\",\n           \"Kentucky\",\n           \"Louisiana\",\n           \"Maine\",\n           \"Maryland\",\n           \"Massachusetts\",\n           \"Michigan\", \n           \"Minnesota\",\n           \"Mississippi\",\n           \"Missouri\",\n           \"Montana\",\n           \"Nebraska\",\n           \"Nevada\",\n           \"New Hampshire\",\n           \"New Jersey\",\n           \"New Mexico\",\n           \"New York\",\n           \"North Carolina\",\n           \"North Dakota\",\n           \"Ohio\",\n           \"Oklahoma\",\n           \"Oregon\",\n           \"Pennsylvania\",\n           \"Rhode Island\",\n           \"South Carolina\",\n           \"South Dakota\",\n           \"Tennessee\",\n           \"Texas\",\n           \"Utah\",\n           \"Vermont\",\n           \"Virginia\",\n           \"Washington\",\n           \"West Virginia\",\n           \"Wisconsin\", \n           \"Wyoming\")\n\npolitical_culture <- c(\"Traditionalistic\", \n                       \"Individualistic\", \n                       \"Traditionalistic\", \n                       \"Traditionalistic\", \n                       \"Moralistic\", \n                       \"Moralistic\", \n                       \"Individualistic\",\n                       \"Individualistic\", \n                       \"Individualistic\", \n                       \"Traditionalistic\",\n                       \"Traditionalistic\", \n                       \"Individualistic\", \n                       \"Moralistic\", \n                       \"Individualistic\", \n                       \"Individualistic\", \n                       \"Moralistic\", \n                       \"Moralistic\", \n                       \"Traditionalistic\", \n                       \"Traditionalistic\", \n                       \"Moralistic\", \n                       \"Individualistic\", \n                       \"Individualistic\", \n                       \"Moralistic\", \n                       \"Moralistic\", \n                       \"Traditionalistic\",\n                       \"Individualistic\",\n                       \"Moralistic\",\n                       \"Individualistic\",\n                       \"Individualistic\",\n                       \"Moralistic\",\n                       \"Individualistic\",\n                       \"Traditionalistic\",\n                       \"Individualistic\",\n                       \"Traditionalistic\",\n                       \"Moralistic\",\n                       \"Individualistic\",\n                       \"Traditionalistic\",\n                       \"Moralistic\",\n                       \"Individualistic\",\n                       \"Individualistic\",\n                       \"Traditionalistic\",\n                       \"Moralistic\", \n                       \"Traditionalistic\",\n                       \"Traditionalistic\",\n                       \"Moralistic\", \n                       \"Moralistic\", \n                       \"Traditionalistic\", \n                       \"Moralistic\", \n                       \"Traditionalistic\",\n                       \"Moralistic\", \n                       \"Individualistic\")\n\npolitical_culture_elazar <- data.frame(state, political_culture) %>%\n  mutate(state = tolower(state))\n\nhead(political_culture_elazar)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       state political_culture\n1    alabama  Traditionalistic\n2     alaska   Individualistic\n3    arizona  Traditionalistic\n4   arkansas  Traditionalistic\n5 california        Moralistic\n6   colorado        Moralistic\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_abortion_data <- state_abortion_data %>%\n  slice(-(1:1)) %>%\n  rename(\n\tArea = 1,\n\tNumber = 2,\n\tRate = 3,\n\tRatio = 4,\n\t`Out-of-State (number and percentage)` = 5,\n\tYear = 6\n  ) %>%\n  mutate(\n\tNumber = ifelse(Number %in% c(\"N/A\"), NA, Number),\n\tRate = ifelse(Rate %in% c(\"N/A\"), NA, Rate),\n\tRatio = ifelse(Ratio %in% c(\"N/A\"), NA, Ratio),\n\t`Out-of-State (number and percentage)` = ifelse(`Out-of-State (number and percentage)` %in% c(\"N/A\"), NA, `Out-of-State (number and percentage)`)\n  )  %>%\n  filter(!(Number %in% c(\"25,619\",\n                     \t\"30,555\",\n                     \t\"35,398\",\n                     \t\"37,523\",\n                     \t\"73,815\",\n                     \t\"89,469\",\n                     \t\"59,854\",\n                     \t\"27,471\"))) %>%\n  mutate(Number = as.numeric(gsub(\",\", \"\", Number)),\n     \tRate = as.numeric(gsub(\",\", \"\", Rate)),\n     \tRatio = as.numeric(gsub(\",\", \"\", Ratio)),\n     \tYear = as.numeric(gsub(\",\", \"\", Year))\n     \t) %>%\n  mutate(Area = tolower(Area)) %>%\n  mutate(Abortions_per_1000_women = Rate) %>%\n  mutate(Abortions_per_1000_live_births = Ratio) %>%\n  mutate(`Out_of_state_abortions(number and percentage)` = `Out-of-State (number and percentage)`) %>%\n  select(Area, Abortions_per_1000_women, Abortions_per_1000_live_births, Year, `Out_of_state_abortions(number and percentage)`)\n\nhead(state_abortion_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Area Abortions_per_1000_women Abortions_per_1000_live_births Year\n1    alabama                      6.0                             99 2020\n2     alaska                      8.4                            127 2020\n3    arizona                      9.3                            172 2020\n4   arkansas                      5.4                             89 2020\n5 california                       NA                             NA 2020\n6   colorado                      8.3                            160 2020\n  Out_of_state_abortions(number and percentage)\n1                                    875 (15.3)\n2                                       8 (0.7)\n3                                      72 (0.5)\n4                                    390 (12.4)\n5                                          <NA>\n6                                  1,283 (13.0)\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_immigration_data <- state_immigration_data %>%\n   slice(-(1:6)) %>%\n  rename(\n    `Current residence in`  = 1,\n    `Population 1 year and over: Estimate` = 2,\n    `Population 1 year and over: MOE` = 3,\n    `Same house 1 year ago: Estimate` = 4,\n    `Same house 1 year ago: MOE` = 5,\n    `Same state of residence 1 year ago: Estimate` = 6,\n    `Same state of residence 1 year ago: MOE` = 7,\n    `Different state of residence 1 year ago: Estimate` = 8,\n    `Different state of residence 1 year ago: MOE` = 9,\n    Year = 10\n  ) %>%\n  slice(-(1:6)) %>%\n  mutate(\n    `Population 1 year and over: Estimate` = as.numeric(\n      gsub(\",\", \"\", `Population 1 year and over: Estimate`)\n      ),\n    `Same house 1 year ago: Estimate` = as.numeric(\n      gsub(\",\", \"\", `Same house 1 year ago: Estimate`)\n      ), \n    `Same state of residence 1 year ago: Estimate` = as.numeric(\n      gsub(\",\", \"\", `Same state of residence 1 year ago: Estimate`)\n      ), \n    `Different state of residence 1 year ago: Estimate` = as.numeric(\n      gsub(\",\", \"\", `Different state of residence 1 year ago: Estimate`)\n      )\n    ) \n\nhead(state_immigration_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Current residence in Population 1 year and over: Estimate\n1              colorado                              5757628\n2           connecticut                              3571470\n3              delaware                               994669\n4 district of columbia                                661026\n5               florida                             21590684\n6               georgia                             10688429\n  Population 1 year and over: MOE Same house 1 year ago: Estimate\n1                       +/- 4,091                         4794481\n2                       +/- 3,191                         3168509\n3                       +/- 1,764                          889174\n4                       +/- 1,835                          527167\n5                       +/- 8,058                        18571567\n6                       +/- 6,334                         9243299\n  Same house 1 year ago: MOE Same state of residence 1 year ago: Estimate\n1                 +/- 26,077                                       686892\n2                 +/- 15,301                                       279328\n3                  +/- 6,362                                        58180\n4                  +/- 8,611                                        68606\n5                 +/- 47,265                                      2206566\n6                 +/- 38,980                                      1107180\n  Same state of residence 1 year ago: MOE\n1                              +/- 20,293\n2                              +/- 13,726\n3                               +/- 5,692\n4                               +/- 7,109\n5                              +/- 41,666\n6                              +/- 34,938\n  Different state of residence 1 year ago: Estimate\n1                                            250031\n2                                            106618\n3                                             42551\n4                                             57746\n5                                            674740\n6                                            302512\n  Different state of residence 1 year ago: MOE Year\n1                                   +/- 17,084 2020\n2                                    +/- 8,523 2020\n3                                    +/- 4,342 2020\n4                                    +/- 5,874 2020\n5                                   +/- 25,002 2020\n6                                   +/- 17,711 2020\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_economic_data <- state_economic_data %>%\n  rename(\n    State  = 1,\n    `Median Household Income` = 2,\n    Year = 3\n  ) %>%\n  mutate(\n    State = ifelse(State == \"\", NA, State),\n    `Median Household Income` = ifelse(`Median Household Income` == \"\", NA, `Median Household Income`)\n    ) %>%\n  filter(complete.cases(.)) %>%\n  mutate(`Median Household Income` = as.numeric(gsub(\",\", \"\", `Median Household Income`))) %>%\n  mutate(State = tolower(State))\n\nhead(state_economic_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              State Median Household Income Year\n1 the united states                   76660 2020\n2           alabama                   61650 2020\n3            alaska                   84260 2020\n4           arizona                   75620 2020\n5          arkansas                   57240 2020\n6        california                   87530 2020\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npresidential_election_data <- presidential_election_data %>%\n  subset(select = -c(X1, X, TOTAL.VOTES, TOTAL.VOTES..)) %>%\n  mutate(\n    FEC.ID = ifelse(FEC.ID == \"n/a\", NA, FEC.ID),\n    `GENERAL.RESULTS` = as.numeric(gsub(\",\", \"\", `GENERAL.RESULTS`)),\n    STATE = tolower(STATE),\n    `R Share of General` = as.numeric(gsub(\"%\", \"\", `GENERAL..`)) / 100\n  ) %>%\n  filter(PARTY == \"R\") %>%\n  select(STATE, `R Share of General`, YEAR)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nâ„¹ In argument: `GENERAL.RESULTS = as.numeric(gsub(\",\", \"\", GENERAL.RESULTS))`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\nhead(presidential_election_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       STATE R Share of General YEAR\n1    alabama             0.6055 2012\n2     alaska             0.5480 2012\n3    arizona             0.5365 2012\n4   arkansas             0.6057 2012\n5 california             0.3712 2012\n6   colorado             0.4613 2012\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nabortion_and_economic <- full_join(state_abortion_data, \n             state_economic_data,\n             by = c(\"Area\" = \"State\",\n                    \"Year\" = \"Year\"))\n\nabortion_and_economic <- abortion_and_economic %>%\n  mutate(Year = as.numeric(gsub(\",\", \"\", Year)))\n\nstate_immigration_data <- state_immigration_data %>%\n  mutate(Year = as.numeric(gsub(\",\", \"\", Year))) \n\nculture_president <- left_join(presidential_election_data, \n                               political_culture_elazar,\n                               by = c(\"STATE\"= \"state\")) \n\neverything_but_immigration <- left_join(culture_president, \n                                        abortion_and_economic,\n                                        by = c(\"STATE\" = \"Area\",\n                                               \"YEAR\" = \"Year\"))\n\nall_variables_dataset<- full_join(everything_but_immigration, \n                                  state_immigration_data, \n                                  by = c(\"STATE\" = \"Current residence in\", \n                                         \"YEAR\" = \"Year\"))\n\nhead(all_variables_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       STATE R Share of General YEAR political_culture Abortions_per_1000_women\n1    alabama             0.6055 2012  Traditionalistic                      9.5\n2     alaska             0.5480 2012   Individualistic                     11.1\n3    arizona             0.5365 2012  Traditionalistic                     10.4\n4   arkansas             0.6057 2012  Traditionalistic                      6.6\n5 california             0.3712 2012        Moralistic                       NA\n6   colorado             0.4613 2012        Moralistic                      9.5\n  Abortions_per_1000_live_births Out_of_state_abortions(number and percentage)\n1                            155                                          17.8\n2                            146                                           0.8\n3                            154                                             1\n4                             99                                          11.1\n5                             NA                                          <NA>\n6                            153                                           8.9\n  Median Household Income Population 1 year and over: Estimate\n1                   53970                              4781296\n2                   79030                               725193\n3                   58410                              6543362\n4                   48450                              2923642\n5                   70800                             37873189\n6                   71090                              5206012\n  Population 1 year and over: MOE Same house 1 year ago: Estimate\n1                       +/- 3,371                         4067683\n2                       +/- 1,551                          583799\n3                       +/- 4,567                         5321158\n4                       +/- 3,216                         2475807\n5                       +/- 9,076                        32197933\n6                       +/- 3,835                         4186643\n  Same house 1 year ago: MOE Same state of residence 1 year ago: Estimate\n1                 +/- 20,967                                       594583\n2                  +/- 9,191                                        99953\n3                 +/- 29,468                                       941347\n4                 +/- 16,481                                       367837\n5                 +/- 60,116                                      4898331\n6                 +/- 26,465                                       778520\n  Same state of residence 1 year ago: MOE\n1                              +/- 19,882\n2                               +/- 8,006\n3                              +/- 27,201\n4                              +/- 13,479\n5                              +/- 56,784\n6                              +/- 23,616\n  Different state of residence 1 year ago: Estimate\n1                                            104102\n2                                             34360\n3                                            236146\n4                                             70621\n5                                            485477\n6                                            206543\n  Different state of residence 1 year ago: MOE\n1                                    +/- 7,789\n2                                    +/- 4,808\n3                                   +/- 10,894\n4                                    +/- 8,082\n5                                   +/- 17,797\n6                                   +/- 11,855\n```\n:::\n:::\n\n\n## Reason for Choosing this Dataset\n\n*High level goal:* To gather data from online repositories regarding immigration and immigration policy, and use it to create a spacial-temporal visualization illustrating our topic of interest in a clear and concise fashion.\n\nWe are interested in exploring the relationship between sanctuary cities and immigration, especially those in the South Atlantic and East South Central regions of the US (Kentucky, West Virginia, Virginia, Maryland, Delaware, DC, Tennessee, North Carolina, South Carolina, Georgia, Alabama, Mississippi, and Florida). We will focus on numbers of incomers within and around sanctuary cities, as well as their change over time (between roughly 2013-2022). We are also curious if the number of immigrants compared to nonimmigrants arriving to the city changed based on the city's immigration policy. We will incorporate the introduction of different immigration policies into our analysis in order to determine correlations between these policies and immigration to the South.\n\n*Description of Dataset:* This dataset contains data on immigration from the Department of Homeland Security (DHS). It groups immigration data by state, reporting on the number of lawful permanent residents (and their rank compared to other states), as well as the number of nonimmigrants, naturalizations, refugees, and asylees over the past ten years. We are pulling the data relevant to the states in our region of interest (Kentucky, West Virginia, Virginia, Maryland, Delaware, DC, Tennessee, North Carolina, South Carolina, Georgia, Alabama, Mississippi, and Florida). We will use the variables for total arrival counts of various types of immigrants, as well as years, to find the correlation between immigration and immigration policy and determine the effect, if any, that policy has on immigration to the South.\n\n## Questions and Analysis Plan\n\nOur primary research question is: How does a city's status as a sanctuary city affect the number of incoming immigrants compared to nonimmigrants, and how has this relationship changed over time?\n\n## Weekly Plan of Attack\n\n*Week 10* - Submit proposal.qmd, research changes in sanctuary state policy between 2013-2022 in the states we've chosen, for the purpose of visualizing.\n\n*Week 11* - Wrangle and tidy dataset, will include removing rows, using a handful of pivot_longer functions, etc. Update proposal and project to include feedback from peers. We will work to create visualizations tied to geospatial data. The sanctuary state visualization will also be conducted. Outline the writeup.\n\n*Week 12* - Complete work on the writeup, which will go in the index.qmd file. This will be done by all group members. Begin work on presentation.qmd.\n\n*Week 13* - Touch up the presentation.qmd file, practice the presentation to ensure it fits within time constraints.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}