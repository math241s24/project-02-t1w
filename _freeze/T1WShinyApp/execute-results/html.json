{
  "hash": "233b8c254e2701c91d6acb6308fbb44a",
  "result": {
    "markdown": "::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\nBreaking News: tmap 3.x is retiring. Please test v4, e.g. with\nremotes::install_github('r-tmap/tmap')\n\n\nAttaching package: 'maps'\n\n\nThe following object is masked from 'package:purrr':\n\n    map\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There were 4 warnings in `mutate()`.\nThe first warning was:\nℹ In argument: `Different state of residence 1 year ago: MOE =\n  as.numeric(gsub(\",\", \"\", \"+/-\", `Different state of residence 1 year ago:\n  MOE`))`.\nCaused by warning:\n! NAs introduced by coercion\nℹ Run `dplyr::last_dplyr_warnings()` to see the 3 remaining warnings.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `GENERAL.RESULTS = as.numeric(gsub(\",\", \"\", GENERAL.RESULTS))`.\nCaused by warning:\n! NAs introduced by coercion\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrsconnect::setAccountInfo(name='jamesono', token='11E2EC17D4FB42DE212783B0C6A4B82E', secret='kQ4wpjs36zEXbUN+4SKgeYGquvFlAoDmVVOfXoRJ')\n\nall_variables_dataset <- subset(all_variables_dataset, YEAR != 2016)\n\nusMap <- function(dataset, variable) {\n  us_map_data <- map_data(\"state\")\n  merged_data <- merge(us_map_data, dataset, by.x = \"region\", by.y = \"STATE\", all.x = TRUE)\n\n  color_gradients <- list(\n    \"R Share of General\" = c(\"white\", \"deeppink4\"), \n    \"Median Household Income\" = c(\"white\", \"darkcyan\"), \n    \"Abortions_per_1000_women\" = c(\"white\", \"chartreuse4\"),\n    \"Abortions_per_1000_live_births\" = c(\"white\", \"chartreuse4\"),\n    \"Same house 1 year ago: Estimate\" = c(\"white\", \"chocolate4\"),\n    \"Population 1 year and over: Estimate\" = c(\"white\", \"chocolate4\"),\n    \"Same state of residence 1 year ago: Estimate\" = c(\"white\", \"chocolate4\"),\n    \"Different state of residence 1 year ago: Estimate\" = c(\"white\", \"chocolate4\")\n  )\n  \n  gradient_colors <- color_gradients[[variable]]\n  \n  g <- ggplot(merged_data) +\n    geom_polygon(aes(x = long, y = lat, group = group, fill = .data[[variable]]),\n                 color = \"gray70\", size = 0.5) +\n    scale_fill_gradient(\n      low = gradient_colors[1], \n      high = gradient_colors[2],\n      na.value = \"grey\",\n      limits = range(dataset[[variable]])\n    ) +\n    theme_void() +\n    theme(legend.position = \"bottom\") +\n    theme(legend.key.width = unit(2, \"cm\"))\n  \n  return(g)\n}\n\nui <- fluidPage(\n  titlePanel(\"Why Move? Finding State Attractiveness\"),\n  mainPanel(\n    selectInput(\"variable\", \"Variable:\", \n                choices = colnames(all_variables_dataset)[!colnames(all_variables_dataset) %in% c(\"STATE\", \"YEAR\", \"Out_of_state_abortions(number and percentage)\", \"Different state of residence 1 year ago: MOE\", \"Same state of residence 1 year ago: MOE\", \"Same house 1 year ago: MOE\", \"Population 1 year and over: MOE\", \"political_culture\")]),\n    selectInput(\"year\", \"Year:\", choices = unique(all_variables_dataset$YEAR)),\n    plotOutput(\"us_map\", width = \"750px\", height = \"450px\")\n  )\n)\n\nserver <- function(input, output) {\n  output$us_map <- renderPlot({\n    subset_data <- all_variables_dataset[all_variables_dataset$YEAR == input$year, ]\n    \n    if (nrow(subset_data) == 0) {\n      return(\"No data available for the selected year.\")\n    }\n    \n    usMap(subset_data, input$variable)\n  })\n}\n\nshinyApp(ui = ui, server = server)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nListening on http://127.0.0.1:6784\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](T1WShinyApp_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::",
    "supporting": [
      "T1WShinyApp_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}